<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Calle a Calle</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <link rel="stylesheet" href="style.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="background-map"></div>
    <div id="login-screen">
      <section class="p-2 bg-gradient-to-r from-blue-800 to-purple-800 rounded-3xl">
        <div class="p-8 text-white bg-gray-900 border-8 border-transparent rounded-2xl shadow-xl bg-opacity-80 backdrop-blur-sm">
          <h1 class="text-5xl font-bold text-center cursor-default">Calle a Calle</h1>
          <p class="mt-2 mb-8 text-center text-gray-300">Inicia sesión para empezar a jugar</p>
          <div class="flex justify-center">
            <button id="google-login-btn" class="p-3 bg-white rounded-full shadow-lg login-btn hover:scale-105 transition transform duration-300">
              <img class="w-10 h-10" loading="lazy" src="https://ucarecdn.com/8f25a2ba-bdcf-4ff1-b596-088f330416ef/" alt="Google" />
            </button>
          </div>
        </div>
      </section>
    </div>

    <div id="game-screen" class="hidden">
        
        <div id="game-map-container"></div>
        
        <button id="report-incident-btn" aria-label="Reportar incidencia">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26.38 25.47"><g><path d="M23.38,1.5H3c-1.1,0-2,.9-2,2V16.67c0,1.1,.9,2,2,2h.5v5.3l5.3-5.3h14.58c1.1,0,2-.9,2-2V3.5c0-1.1-.9-2-2-2Z" style="fill: #5f657f;"/><rect x="6.06" y="7.5" width="14.25" height="4.25" rx="2.13" ry="2.13" style="fill: #fff;"/></g></svg>
        </button>

        <div id="question-area" class="hidden">
            <span id="question-prompt">¿Dónde está...?</span>
            <div id="street-name-box"><span id="street-name-text"></span></div>
        </div>
        
        <div id="progress-bar-container" class="hidden"><div id="progress-bar"></div></div>
        
        <div id="bottom-bar">
            <svg viewBox="0 0 414.03 191.13" id="bottom-svg">
                 <g class="cls-1">
                    <g id="Capa_2" data-name="Capa 2">
                        <g id="Capa_1-2" data-name="Capa 1">
                            <path class="cls-12" d="M40.23,0H373.8c22.21,0,40.23,18,40.23,40.23V150.9c0,22.21-18,40.23-40.23,40.23H40.23C18,191.13,0,173.11,0,150.9V40.23C0,18,18,0,40.23,0Z"/>
                            
                            <g id="info-panel">
                                <rect class="cls-13" x="19.01" y="19.5" width="274.45" height="49.03" rx="24.51" ry="24.51"/>
                                <foreignObject x="30" y="22" width="250" height="45">
                                    <div xmlns="http://www.w3.org/1999/xhtml" class="info-panel-content">
                                        <span class="logo-text">Calle a Calle</span>
                                        <span id="info-text">Dibuja una zona para empezar</span>
                                    </div>
                                </foreignObject>
                            </g>

                            <g id="menu-btn-group" style="cursor: pointer;">
                                <circle class="cls-11" cx="42.5" cy="144.5" r="24"/>
                                <g>
                                    <rect class="cls-14" x="32" y="134" width="21" height="21" />
                                    <foreignObject x="32" y="134" width="21" height="21">
                                        <div xmlns="http://www.w3.org/1999/xhtml" class="menu-icon">
                                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"></path></svg>
                                        </div>
                                    </foreignObject>
                                </g>
                            </g>

                            <g id="poi-switch-container">
                                 <foreignObject x="85" y="125" width="150" height="48">
                                      <div xmlns="http://www.w3.org/1999/xhtml" class="poi-switch-content">
                                        <label for="poi-checkbox" class="poi-label">Incluir PDI</label>
                                        <label class="switch">
                                            <input type="checkbox" id="poi-checkbox">
                                            <span class="slider round"></span>
                                        </label>
                                    </div>
                                </foreignObject>
                            </g>
                            
                             <g id="main-action-btn-group" style="cursor: pointer;">
                                <rect class="cls-10" x="240" y="85" width="155" height="85" rx="30" ry="30"/>
                                 <foreignObject x="240" y="85" width="155" height="85">
                                    <button xmlns="http://www.w3.org/1999/xhtml" id="main-action-btn" class="action-btn btn-blue">
                                        Establecer Zona
                                    </button>
                                </foreignObject>
                            </g>
                            
                            <g id="user-avatar-group" style="cursor: pointer;">
                                <circle class="cls-15" cx="351.5" cy="44.5" r="24"/>
                                <foreignObject x="327.5" y="20.5" width="48" height="48">
                                     <img xmlns="http://www.w3.org/1999/xhtml" id="user-avatar" class="user-avatar-img" src="https://placehold.co/48x48/2b324c/FFF?text=U" alt="User"/>
                                </foreignObject>
                            </g>
                        </g>
                    </g>
                </g>
            </svg>
        </div>

        <div id="feedback-popup"><span id="feedback-text"></span></div>
        
        <div id="report-modal" class="modal-overlay hidden">
            <div class="modal-content">
                <h3 class="modal-title">Reportar una incidencia</h3>
                <p class="modal-description">¿Has encontrado un error o tienes alguna sugerencia? ¡Cuéntanos!</p>
                <textarea id="report-textarea" placeholder="Describe el problema o tu idea..."></textarea>
                <div class="modal-actions">
                    <button id="cancel-report-btn">Cancelar</button>
                    <button id="submit-report-btn">Enviar</button>
                </div>
            </div>
        </div>

        <div id="menu-overlay" class="modal-overlay hidden">
            <div id="menu-content" class="menu-panel-container">
                <button id="close-menu-btn">&times;</button>
                <div id="menu-tabs">
                    <button class="menu-tab-btn active" data-panel="profile-content">Perfil</button>
                    <button class="menu-tab-btn" data-panel="saved-zones-content">Mis Zonas</button>
                    <button class="menu-tab-btn" data-panel="stats-content">Estadísticas</button>
                </div>
                <div id="profile-content" class="menu-panel active"></div>
                <div id="saved-zones-content" class="menu-panel"></div>
                <div id="stats-content" class="menu-panel"></div>
            </div>
        </div>

    </div>

    <audio id="correct-sound" src="sounds/correct.mp3" preload="auto"></audio>
    <audio id="incorrect-sound" src="sounds/incorrect.mp3" preload="auto"></audio>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="main.js"></script>
</body>
</html>